# TOM v3.0 - Realtime Pipeline Environment (ohne Mocks)
# Echte Provider-Konfiguration

# =============================================================================
# REALTIME COMPONENT MODES (ohne Mocks)
# =============================================================================
REALTIME_STT=provider          # provider = Realtime-API, local = WhisperX
REALTIME_LLM=provider         # provider = Realtime-API Tokens
REALTIME_TTS=provider         # provider = Realtime-API Audio, local = Piper

# =============================================================================
# PROVIDER CONFIGURATION
# =============================================================================

# OpenAI Realtime API
REALTIME_WS_URL=wss://api.openai.com/v1/realtime
REALTIME_API_KEY=your_openai_api_key_here
REALTIME_MODEL=gpt-4o-realtime-preview-2024-10-01
REALTIME_LANGUAGE=de

# Alternative: Azure Cognitive Services
# REALTIME_WS_URL=wss://speech.microsoft.com/speech/transcription/conversation/v1
# REALTIME_API_KEY=your_azure_speech_key_here
# REALTIME_MODEL=whisper-1
# REALTIME_LANGUAGE=de-DE

# =============================================================================
# LOCAL COMPONENTS (Fallback/Option)
# =============================================================================

# WhisperX (falls REALTIME_STT=local)
WHISPERX_MODEL=large-v2
WHISPERX_DEVICE=cuda
WHISPERX_COMPUTE_TYPE=float16
WHISPERX_LANGUAGE=de

# Piper TTS (falls REALTIME_TTS=local)
PIPER_VOICE=de-DE-thorsten-medium
PIPER_PATH=piper
PIPER_SAMPLE_RATE=16000

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# JWT Configuration
JWT_SECRET=your_jwt_secret_key_here
JWT_EXPIRY_SECONDS=3600

# Rate Limiting
RATE_LIMIT_MSGS_PER_SEC=120
RATE_LIMIT_WINDOW_SEC=1
MAX_FRAME_SIZE=65536

# Redis (für JWT Replay-Schutz)
REDIS_URL=redis://localhost:6379

# =============================================================================
# DEVELOPMENT FLAGS
# =============================================================================

# DEV-Modus (nur für lokale Entwicklung!)
DEV_ALLOW_NO_JWT=false        # JWT-Validierung deaktivieren
DEV_MOCK_DELAYS=false         # Keine Mock-Delays
DEV_LOG_LEVEL=INFO            # Logging-Level

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================

# Audio Processing
AUDIO_SAMPLE_RATE=16000
AUDIO_CHUNK_SIZE_MS=20
AUDIO_FRAME_SIZE_SAMPLES=320

# Pipeline Timeouts
STT_TIMEOUT_SEC=5
LLM_TIMEOUT_SEC=10
TTS_TIMEOUT_SEC=5
E2E_TIMEOUT_SEC=15

# =============================================================================
# MONITORING & METRICS
# =============================================================================

# Prometheus Metrics
PROMETHEUS_PORT=9090
ENABLE_METRICS=true

# Latenz-Schwellwerte (für Alerts)
LATENCY_THRESHOLD_STT_MS=300
LATENCY_THRESHOLD_LLM_MS=200
LATENCY_THRESHOLD_TTS_MS=100
LATENCY_THRESHOLD_E2E_MS=800

# =============================================================================
# CORS & SECURITY HEADERS
# =============================================================================

# CORS Origins (komma-getrennt)
CORS_ORIGINS=http://localhost:3000,http://localhost:3003

# Security Headers
SECURITY_HEADERS=true
CONTENT_SECURITY_POLICY=default-src 'self'

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log-Format
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# Log-Dateien
LOG_FILE=logs/realtime.log
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=5

# PII-Schutz
LOG_MASK_PII=true
LOG_MASK_AUDIO=true

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================

# E2E-Test Konfiguration
E2E_TEST_TIMEOUT_SEC=30
E2E_TEST_AUDIO_DURATION_SEC=1
E2E_TEST_FREQUENCY_HZ=440

# Test-Daten
TEST_CALL_ID_PREFIX=e2e-test
TEST_JWT_TOKEN=dev-test-token

# =============================================================================
# BACKUP CONFIGURATION (für lokale Entwicklung)
# =============================================================================

# Falls Provider nicht verfügbar, lokale Komponenten verwenden
FALLBACK_TO_LOCAL=true
FALLBACK_STT_MODEL=whisperx
FALLBACK_LLM_MODEL=ollama
FALLBACK_TTS_MODEL=piper

# Ollama (falls FALLBACK_LLM_MODEL=ollama)
OLLAMA_HOST=http://localhost:11434
OLLAMA_MODEL=qwen3:14b

# =============================================================================
# AUDIO RECORDING & QUALITÄTSPRÜFUNG (DSGVO-konform)
# =============================================================================

# Audio-Aufzeichnung (nur für interne Qualitätstests!)
RECORD_AUDIO=false                    # true = Aufzeichnung aktiviert
RECORD_PATH=./data/recordings         # Speicherort für Aufnahmen
RECORD_RETENTION_HOURS=24            # Auto-Cleanup nach X Stunden

# Qualitätsprüfung
QC_ENABLED=true                      # Qualitätsprüfung aktivieren
QC_RMS_MIN=300                       # Mindest-RMS-Level
QC_RMS_MAX=9000                      # Maximal-RMS-Level
QC_CLIP_THRESHOLD=0.001              # Clipping-Schwellwert
QC_DC_THRESHOLD=200                  # DC-Offset-Schwellwert
QC_SNR_MIN=20                        # Mindest-SNR in dB
